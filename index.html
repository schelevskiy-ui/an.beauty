<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Lash Assistant - annazhdanova.beauty</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0a0a0a; --pink: #eebec6; --neon: #ff007f; --glass: rgba(255, 255, 255, 0.03); --border: rgba(255, 255, 255, 0.08); }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Montserrat', sans-serif; background-color: var(--bg); color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; background-image: radial-gradient(circle at 50% 50%, #1a1012 0%, #0a0a0a 100%); }
        .container { width: 100%; max-width: 500px; text-align: center; }
        h1 { font-family: 'Playfair Display', serif; font-size: 2.5rem; margin-bottom: 5px; background: linear-gradient(to right, #fff, var(--pink)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .brand-neon { font-family: 'Playfair Display', serif; font-size: 1.3rem; font-weight: 900; color: var(--neon); text-shadow: 0 0 15px var(--neon); display: block; margin-bottom: 30px; }
        .upload-card { background: var(--glass); backdrop-filter: blur(20px); border: 1px solid var(--border); border-radius: 30px; padding: 50px 20px; cursor: pointer; transition: 0.4s; }
        .upload-card:hover { border-color: var(--pink); background: rgba(255, 255, 255, 0.06); }
        .upload-icon { font-size: 50px; margin-bottom: 15px; display: block; }
        #fileInput { display: none; }
        #previewContainer { margin-top: 25px; display: none; width: 100%; }
        #imagePreview { width: 100%; border-radius: 20px; border: 1px solid var(--pink); }
        .loader { display: none; margin: 30px 0; }
        .spinner { width: 40px; height: 40px; border: 3px solid rgba(238, 190, 198, 0.1); border-top: 3px solid var(--pink); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #resultCard { display: none; background: rgba(238, 190, 198, 0.07); border: 1px solid rgba(238, 190, 198, 0.3); border-radius: 30px; padding: 30px; margin-top: 25px; text-align: left; }
        .result-text { line-height: 1.8; font-size: 1rem; color: #f0f0f0; white-space: pre-line; }
        .result-text h4 { color: var(--pink); margin: 20px 0 10px 0; font-family: 'Playfair Display', serif; border-left: 3px solid var(--neon); padding-left: 15px; }
        .copy-btn { background: var(--pink); color: #000; border: none; width: 100%; padding: 15px; border-radius: 15px; font-weight: 800; cursor: pointer; text-transform: uppercase; margin-bottom: 20px; }
        #debugInfo { font-size: 0.65rem; color: #555; margin-top: 20px; font-family: monospace; text-align: left; background: #000; padding: 10px; border-radius: 10px; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI Lash Assistant</h1>
        <span class="brand-neon">annazhdanova.beauty</span>
        <div class="upload-card" id="dropZone" onclick="document.getElementById('fileInput').click()">
            <span class="upload-icon">üì∏</span>
            <h3>–ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–≥–ª—è–¥</h3>
            <p>–î–æ–¥–∞–π—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è –º–∏—Ç—Ç—î–≤–æ—ó —Å—Ö–µ–º–∏</p>
            <input type="file" id="fileInput" accept="image/*">
        </div>
        <div id="previewContainer"><img id="imagePreview" src=""></div>
        <div class="loader" id="loader">
            <div class="spinner"></div>
            <p id="loaderText" style="color: var(--pink); font-size: 0.8rem;">–®—É–∫–∞—î–º–æ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∫–∞–Ω–∞–ª –®–Ü...</p>
        </div>
        <div id="resultCard">
            <button class="copy-btn" onclick="copyResult()">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Å—Ö–µ–º—É ‚ú®</button>
            <div class="result-text" id="resultText"></div>
        </div>
        <div id="debugInfo"></div>
        <p style="margin-top: 40px; font-size: 0.7rem; opacity: 0.3; cursor: pointer;" onclick="location.reload()">–°–∫–∏–Ω—É—Ç–∏ —Ç–∞ –ø–æ—á–∞—Ç–∏ –∑–∞–Ω–æ–≤–æ</p>
    </div>

    <script>
        const p1 = "AIzaSyAgrdsEd9A1";
        const p2 = "Uf5uneSzgGPoYSTYUS8D0xY";
        const KEY = p1 + p2;

        const debug = (msg) => { 
            const d = document.getElementById('debugInfo');
            d.style.display = 'block';
            d.innerHTML += `> ${msg}<br>`;
            console.log(msg);
        };

        fileInput.onchange = function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imagePreview').src = e.target.result;
                    document.getElementById('previewContainer').style.display = 'block';
                    document.getElementById('dropZone').style.display = 'none';
                    startSmartProcess(e.target.result);
                }
                reader.readAsDataURL(file);
            }
        };

        async function startSmartProcess(base64Url) {
            const loader = document.getElementById('loader');
            loader.style.display = 'block';
            debug("–ü–æ—á–∏–Ω–∞—î–º–æ –ø—Ä–æ—Ü–µ—Å –∞–≤—Ç–æ-—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è...");

            try {
                // –ö–†–û–ö 1: –ü–ï–†–ï–í–Ü–†–ö–ê –î–û–°–¢–£–ü–ù–ò–• –ú–û–î–ï–õ–ï–ô
                debug("–ó–∞–ø–∏—Ç—É—î–º–æ —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π —É Google...");
                const modelsResp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${KEY}`);
                const modelsData = await modelsResp.json();

                if (modelsData.error) throw new Error(`–ü–æ–º–∏–ª–∫–∞ –∫–ª—é—á–∞: ${modelsData.error.message}`);

                // –®—É–∫–∞—î–º–æ –ø–µ—Ä—à—É –ª—ñ–ø—à—É –º–æ–¥–µ–ª—å Gemini, —è–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é
                const availableModels = modelsData.models || [];
                debug(`–ó–Ω–∞–π–¥–µ–Ω–æ ${availableModels.length} –º–æ–¥–µ–ª–µ–π.`);
                
                const workingModel = availableModels.find(m => 
                    m.name.includes("gemini") && 
                    m.supportedGenerationMethods.includes("generateContent")
                );

                if (!workingModel) throw new Error("–£ –≤–∞—à–æ–º—É –∞–∫–∞—É–Ω—Ç—ñ –Ω–µ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ –∂–æ–¥–Ω–æ—ó –º–æ–¥–µ–ª—ñ Gemini.");
                
                debug(`–û–±—Ä–∞–Ω–æ —Ä–æ–±–æ—á—É –º–æ–¥–µ–ª—å: ${workingModel.name}`);

                // –ö–†–û–ö 2: –ê–ù–ê–õ–Ü–ó
                const mimeType = base64Url.split(';')[0].split(':')[1];
                const base64Data = base64Url.split(',')[1];
                
                const prompt = `–¢–∏ ‚Äî –ø—Ä–æ–≤—ñ–¥–Ω–∏–π –µ–∫—Å–ø–µ—Ä—Ç –ª–µ—à–º–µ–π–∫–µ—Ä –∫–æ–º–∞–Ω–¥–∏ annazhdanova.beauty. 
                –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π —Ñ–æ—Ä–º—É –æ—á–µ–π –Ω–∞ —Ñ–æ—Ç–æ —Ç–∞ –≤–∏–¥–∞–π —Ç–æ—á–Ω—É —Å—Ö–µ–º—É.
                –û–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–æ–ø–∏—Å—É–π –≤—ñ–¥–ø–æ–≤—ñ–¥—å –¥–æ –∫—ñ–Ω—Ü—è.
                –§–æ—Ä–º–∞—Ç: <h4>üëÅÔ∏è –ê–Ω–∞—Ç–æ–º—ñ—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä</h4> (–æ–ø–∏—Å) <h4>‚ú® –°—Ö–µ–º–∞</h4> (–µ—Ñ–µ–∫—Ç, –≤–∏–≥–∏–Ω, –¥–æ–≤–∂–∏–Ω–∏).
                –ü–∏—à–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –∑ –µ–º–æ–¥–∑—ñ. –ñ–æ–¥–Ω–∏—Ö –∑—ñ—Ä–æ—á–æ–∫.`;

                debug("–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–ø–∏—Ç –Ω–∞ –∞–Ω–∞–ª—ñ–∑...");
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/${workingModel.name}:generateContent?key=${KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }, { inline_data: { mime_type: mimeType, data: base64Data } }] }],
                        generationConfig: { temperature: 0.7, maxOutputTokens: 1500 }
                    })
                });

                const resultData = await response.json();
                if (resultData.error) throw new Error(resultData.error.message);

                const text = resultData.candidates[0].content.parts[0].text;
                document.getElementById('resultText').innerHTML = text.replace(/\*/g, '');
                loader.style.display = 'none';
                document.getElementById('resultCard').style.display = 'block';
                debug("–£—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ.");

            } catch (error) {
                loader.style.display = 'none';
                document.getElementById('dropZone').style.display = 'block';
                debug(`–ö–†–ò–¢–ò–ß–ù–ê –ü–û–ú–ò–õ–ö–ê: ${error.message}`);
                alert(`–ó–±—ñ–π: ${error.message}`);
            }
        }

        function copyResult() {
            navigator.clipboard.writeText(document.getElementById('resultText').innerText).then(() => alert("–°—Ö–µ–º—É –∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!"));
        }
    </script>
</body>
</html>
