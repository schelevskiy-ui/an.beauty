<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Lash Assistant - annazhdanova.beauty</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #0f0f0f;
            --pink: #eebec6;
            --neon: #ff007f;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-image: radial-gradient(circle at 50% 50%, #1a1012 0%, #0a0a0a 100%);
        }

        .container { width: 100%; max-width: 500px; text-align: center; }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            background: linear-gradient(45deg, #fff, var(--pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .brand-neon {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--neon);
            text-shadow: 0 0 15px var(--neon), 0 0 30px var(--neon);
            display: block;
            margin-bottom: 30px;
        }

        .upload-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 30px;
            padding: 50px 20px;
            cursor: pointer;
            transition: 0.4s ease;
        }

        .upload-card:hover { border-color: var(--pink); transform: translateY(-5px); }
        .upload-icon { font-size: 50px; margin-bottom: 15px; display: block; filter: drop-shadow(0 0 10px var(--pink)); }
        
        #fileInput { display: none; }
        #previewContainer { margin-top: 25px; display: none; width: 100%; }
        #imagePreview { width: 100%; border-radius: 20px; border: 1px solid var(--pink); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        .loader { display: none; margin: 30px 0; }
        .spinner {
            width: 40px; height: 40px;
            border: 3px solid rgba(238, 190, 198, 0.1);
            border-top: 3px solid var(--pink);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        #resultCard {
            display: none;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(238, 190, 198, 0.3);
            border-radius: 30px;
            padding: 30px;
            margin-top: 25px;
            text-align: left;
        }

        .result-content { line-height: 1.7; font-size: 1rem; color: #f0f0f0; }
        .result-content h4 { 
            color: var(--pink); 
            margin: 25px 0 12px 0; 
            font-family: 'Playfair Display', serif; 
            font-size: 1.4rem; 
            border-left: 4px solid var(--neon);
            padding-left: 15px;
        }
        .result-content p { margin-bottom: 12px; }

        .copy-btn {
            background: var(--pink); color: #000; border: none; width: 100%; padding: 15px;
            border-radius: 15px; font-weight: 800; cursor: pointer; text-transform: uppercase;
        }

        .status-tag { font-size: 0.6rem; color: #444; margin-top: 15px; display: block; text-align: center; }
        .reset-link { margin-top: 30px; font-size: 0.75rem; opacity: 0.3; cursor: pointer; display: block; text-align: center; text-decoration: underline; }
    </style>
</head>
<body>

    <div class="container">
        <h1>AI Lash Assistant</h1>
        <span class="brand-neon">annazhdanova.beauty</span>

        <div class="upload-card" id="dropZone" onclick="document.getElementById('fileInput').click()">
            <span class="upload-icon">üëÅÔ∏è</span>
            <h3>–ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–≥–ª—è–¥</h3>
            <p>–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–æ—Ç–æ –æ—á–µ–π</p>
            <input type="file" id="fileInput" accept="image/*">
        </div>

        <div id="previewContainer">
            <img id="imagePreview" src="">
        </div>

        <div class="loader" id="loader">
            <div class="spinner"></div>
            <p id="loaderText" style="color: var(--pink); font-size: 0.9rem;">–ú–∞–π—Å—Ç–µ—Ä –≤–∏–≤—á–∞—î —Ñ–æ—Ç–æ...</p>
        </div>

        <div id="resultCard">
            <button class="copy-btn" onclick="copyResult()">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Å—Ö–µ–º—É ‚ú®</button>
            <div id="resultText" class="result-content"></div>
            <span id="activeModel" class="status-tag"></span>
        </div>

        <p class="reset-link" onclick="location.reload()">–°–∫–∏–Ω—É—Ç–∏ —Ç–∞ –ø–æ—á–∞—Ç–∏ –∑–∞–Ω–æ–≤–æ</p>
    </div>

    <script>
        const p1 = "AIzaSyAgrdsEd9A1";
        const p2 = "Uf5uneSzgGPoYSTYUS8D0xY";
        const KEY = p1 + p2;

        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const imagePreview = document.getElementById('imagePreview');
        const loader = document.getElementById('loader');
        const loaderText = document.getElementById('loaderText');
        const resultCard = document.getElementById('resultCard');
        const resultText = document.getElementById('resultText');
        const activeModelTag = document.getElementById('activeModel');

        fileInput.onchange = function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    previewContainer.style.display = 'block';
                    document.getElementById('dropZone').style.display = 'none';
                    startAnalysis(e.target.result);
                }
                reader.readAsDataURL(file);
            }
        };

        async function getModel() {
            try {
                const r = await fetch(`https://generativelanguage.googleapis.com/v1/models?key=${KEY}`);
                const d = await r.json();
                // –ó–º—ñ–Ω—é—î–º–æ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç: —Å–ø–æ—á–∞—Ç–∫—É 2.0-flash (–≤–æ–Ω–∞ —Å—Ç–∞–±—ñ–ª—å–Ω–∞), –ø–æ—Ç—ñ–º Pro
                const p = ['gemini-2.0-flash', 'gemini-1.5-pro', 'gemini-1.5-flash-latest'];
                for (let n of p) {
                    if (d.models.some(m => m.name.includes(n))) return n.includes('models/') ? n : `models/${n}`;
                }
                return d.models[0].name;
            } catch (e) { return 'models/gemini-1.5-flash'; }
        }

        async function startAnalysis(base64Url) {
            loader.style.display = 'block';
            resultCard.style.display = 'none';

            try {
                const model = await getModel();
                activeModelTag.innerText = "–°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—ó: " + model.split('/')[1];

                const prompt = `–¢–∏ ‚Äî –ø—Ä–æ–≤—ñ–¥–Ω–∏–π –µ–∫—Å–ø–µ—Ä—Ç –ª–µ—à–º–µ–π–∫–µ—Ä –∫–æ–º–∞–Ω–¥–∏ annazhdanova.beauty. 
                –¢–≤–æ—î –∑–∞–≤–¥–∞–Ω–Ω—è: –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤–Ω–∏–π –∞–Ω–∞—Ç–æ–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ñ–æ—Ç–æ. 
                
                –í–ê–ñ–õ–ò–í–û: –û–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–æ–ø–∏—Å—É–π –∫–æ–∂–Ω–µ —Ä–µ—á–µ–Ω–Ω—è –¥–æ –∫—ñ–Ω—Ü—è. –ù–µ –æ–±—Ä–∏–≤–∞–π —Ç–µ–∫—Å—Ç.
                
                –ü–õ–ê–ù –í–Ü–î–ü–û–í–Ü–î–Ü:
                –ü—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è: (–ü—Ä–∏–≤—ñ—Ç–∞–π—Å—è –≤—ñ–¥ —ñ–º–µ–Ω—ñ –±—Ä–µ–Ω–¥—É, –≤–∏—Å–ª–æ–≤–∏ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–æ–≥–ª—è–¥–æ–º).
                1. –ê–Ω–∞—Ç–æ–º—ñ—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä: –û–ø–∏—à–∏ —Ñ–æ—Ä–º—É –æ—á–µ–π, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –Ω–∞–≤–∏—Å–∞–Ω–Ω—è, –Ω–∞–ø—Ä—è–º–æ–∫ —Ä–æ—Å—Ç—É –≤—ñ–π. (3-4 –ø–æ–≤–Ω–∏—Ö —Ä–µ—á–µ–Ω–Ω—è).
                2. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ —Å—Ö–µ–º–∞: 
                   - –ï—Ñ–µ–∫—Ç (–õ–∏—Å–∏—á–∏–π, –ë—ñ–ª—è—á–∏–π —Ç–æ—â–æ)
                   - –í–∏–≥–∏–Ω (–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ)
                   - –°—Ö–µ–º–∞ –¥–æ–≤–∂–∏–Ω (–Ω–∞–ø—Ä. 7-12-10–º–º)
                   - –ß–æ–º—É —Ü–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å (–ü–æ—è—Å–Ω–∏ –≤–∏–±—ñ—Ä).

                –ü–∏—à–∏ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ, —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é, –∑ –µ–º–æ–¥–∑—ñ üíñ. –ñ–æ–¥–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ –∑—ñ—Ä–æ—á–æ–∫ (*) —á–∏ —Ä–µ—à—ñ—Ç–æ–∫ (#).`;

                const payload = {
                    contents: [{ parts: [{ text: prompt }, { inline_data: { mime_type: base64Url.split(';')[0].split(':')[1], data: base64Url.split(',')[1] } }] }],
                    generationConfig: { 
                        temperature: 0.6, // –ó–Ω–∏–∂–µ–Ω–æ –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ, —â–æ–± –®–Ü –Ω–µ "–≥—É–±–∏–≤—Å—è"
                        maxOutputTokens: 1500, 
                        topP: 0.9 
                    }
                };

                const res = await fetch(`https://generativelanguage.googleapis.com/v1/${model}:generateContent?key=${KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await res.json();
                if (data.error) throw new Error(data.error.message);

                let text = data.candidates[0].content.parts[0].text;
                
                // –ì–ª–∏–±–æ–∫–µ –æ—á–∏—â–µ–Ω–Ω—è –≤—ñ–¥ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤
                text = text.replace(/#/g, '');
                text = text.replace(/\*/g, '');
                text = text.replace(/–ü—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è:?/gi, '');
                text = text.replace(/–ê–Ω–∞—Ç–æ–º—ñ—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä:?/gi, '<h4>üëÅÔ∏è –ê–Ω–∞—Ç–æ–º—ñ—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä</h4>');
                text = text.replace(/–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ —Å—Ö–µ–º–∞:?/gi, '<h4>‚ú® –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ —Å—Ö–µ–º–∞</h4>');

                resultText.innerHTML = text;
                loader.style.display = 'none';
                resultCard.style.display = 'block';
                resultCard.scrollIntoView({ behavior: 'smooth' });

            } catch (e) {
                loader.style.display = 'none';
                document.getElementById('dropZone').style.display = 'block';
                alert("–ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.");
            }
        }

        function copyResult() {
            navigator.clipboard.writeText(resultText.innerText).then(() => alert("–°—Ö–µ–º—É –∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! ‚ú®"));
        }
    </script>
</body>
</html>